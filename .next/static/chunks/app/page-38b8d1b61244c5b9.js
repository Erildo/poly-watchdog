(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5196:(e,s,t)=>{Promise.resolve().then(t.bind(t,121))},121:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>k});var i=t(5155),a=t(2115),n=t(9827),r=t(709);let c=(0,n.v)()((0,r.Zr)(e=>({trackedTraders:[],notificationSettings:{enableEntryNotifications:!0,enableExitNotifications:!0,whatsappEnabled:!1},addTrader:s=>e(e=>({trackedTraders:[...e.trackedTraders,{...s,id:crypto.randomUUID(),addedAt:new Date().toISOString()}]})),removeTrader:s=>e(e=>({trackedTraders:e.trackedTraders.filter(e=>e.id!==s)})),toggleNotifications:s=>e(e=>({trackedTraders:e.trackedTraders.map(e=>e.id===s?{...e,notificationsEnabled:!e.notificationsEnabled}:e)})),updateNotificationSettings:s=>e(e=>({notificationSettings:{...e.notificationSettings,...s}}))}),{name:"polymarket-tracker-storage"}));var d=t(3473),l=t(853);function o(){let[e,s]=(0,a.useState)(""),[t,n]=(0,a.useState)(!1),[r,o]=(0,a.useState)(""),x=c(e=>e.addTrader),m=async()=>{if(e.trim()){n(!0),o("");try{let t=e.startsWith("0x")&&42===e.length,i=await fetch("/api/user?".concat(t?"address=".concat(e):"username=".concat(e)));if(!i.ok)throw Error("User not found");let a=await i.json();x({username:a.username||a.address.slice(0,8),address:a.address,notificationsEnabled:!0}),s("")}catch(e){o("Could not find user. Please check username or address.")}finally{n(!1)}}};return(0,i.jsxs)("div",{className:"bg-zinc-900 rounded-lg p-6 border border-zinc-800",children:[(0,i.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[(0,i.jsx)(d.A,{className:"w-5 h-5"}),"Add Trader to Track"]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsxs)("div",{className:"flex-1 relative",children:[(0,i.jsx)(l.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-zinc-500"}),(0,i.jsx)("input",{type:"text",value:e,onChange:e=>s(e.target.value),onKeyPress:e=>"Enter"===e.key&&m(),placeholder:"Enter username or wallet address...",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg pl-10 pr-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:t})]}),(0,i.jsx)("button",{onClick:m,disabled:t||!e.trim(),className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 disabled:bg-zinc-700 disabled:cursor-not-allowed rounded-lg font-medium text-sm transition-colors",children:t?"Adding...":"Track"})]}),r&&(0,i.jsx)("p",{className:"mt-2 text-sm text-red-400",children:r})]})}var x=t(5288),m=t(5560),h=t(5686);function p(){let e=c(e=>e.trackedTraders),s=c(e=>e.removeTrader),t=c(e=>e.toggleNotifications);return 0===e.length?(0,i.jsx)("div",{className:"bg-zinc-900 rounded-lg p-8 border border-zinc-800 text-center",children:(0,i.jsx)("p",{className:"text-zinc-500",children:"No traders tracked yet. Add one above to get started!"})}):(0,i.jsxs)("div",{className:"bg-zinc-900 rounded-lg border border-zinc-800",children:[(0,i.jsx)("div",{className:"p-4 border-b border-zinc-800",children:(0,i.jsxs)("h2",{className:"text-lg font-semibold",children:["Tracked Traders (",e.length,")"]})}),(0,i.jsx)("div",{className:"divide-y divide-zinc-800",children:e.map(e=>(0,i.jsx)("div",{className:"p-4 hover:bg-zinc-800/50 transition-colors",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"font-medium",children:e.username}),(0,i.jsxs)("p",{className:"text-sm text-zinc-500 font-mono",children:[e.address.slice(0,6),"...",e.address.slice(-4)]}),(0,i.jsxs)("p",{className:"text-xs text-zinc-600 mt-1",children:["Added ",new Date(e.addedAt).toLocaleDateString()]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("button",{onClick:()=>t(e.id),className:"p-2 rounded-lg transition-colors ".concat(e.notificationsEnabled?"bg-blue-600 hover:bg-blue-700":"bg-zinc-800 hover:bg-zinc-700"),title:e.notificationsEnabled?"Disable notifications":"Enable notifications",children:e.notificationsEnabled?(0,i.jsx)(x.A,{className:"w-4 h-4"}):(0,i.jsx)(m.A,{className:"w-4 h-4"})}),(0,i.jsx)("button",{onClick:()=>s(e.id),className:"p-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors",title:"Remove trader",children:(0,i.jsx)(h.A,{className:"w-4 h-4"})})]})]})},e.id))})]})}var b=t(8236),u=t(7780),g=t(6118);function f(){let e=c(e=>e.notificationSettings),s=c(e=>e.updateNotificationSettings),[t,n]=(0,a.useState)(e.discordWebhookUrl||""),[r,d]=(0,a.useState)(!1),l=async()=>{if(t){d(!0);try{await fetch("/api/notify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({webhookUrl:t,username:"TestUser",type:"trade",trade:{id:"test",marketId:"test",market:{question:"Will this notification work?",slug:"test",endDate:new Date().toISOString(),volume:1e5,liquidity:5e4},outcome:"YES",type:"BUY",size:100,price:.65,timestamp:new Date().toISOString()}})}),alert("Test notification sent! Check your Discord channel.")}catch(e){alert("Failed to send test notification")}finally{d(!1)}}};return(0,i.jsxs)("div",{className:"bg-zinc-900 rounded-lg p-6 border border-zinc-800",children:[(0,i.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[(0,i.jsx)(b.A,{className:"w-5 h-5"}),"Notification Settings"]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Discord Webhook URL"}),(0,i.jsx)("input",{type:"text",value:t,onChange:e=>n(e.target.value),placeholder:"https://discord.com/api/webhooks/...",className:"w-full bg-zinc-800 border border-zinc-700 rounded-lg px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono"}),(0,i.jsx)("p",{className:"mt-1 text-xs text-zinc-500",children:"Create a webhook in your Discord server: Server Settings → Integrations → Webhooks"})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsxs)("button",{onClick:()=>{s({discordWebhookUrl:t})},disabled:!t,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-zinc-700 disabled:cursor-not-allowed rounded-lg font-medium text-sm transition-colors",children:[(0,i.jsx)(u.A,{className:"w-4 h-4"}),"Save Webhook"]}),(0,i.jsxs)("button",{onClick:l,disabled:!t||r,className:"flex items-center gap-2 px-4 py-2 bg-zinc-700 hover:bg-zinc-600 disabled:bg-zinc-800 disabled:cursor-not-allowed rounded-lg font-medium text-sm transition-colors",children:[(0,i.jsx)(g.A,{className:"w-4 h-4"}),r?"Sending...":"Test Notification"]})]}),(0,i.jsxs)("div",{className:"pt-4 border-t border-zinc-800",children:[(0,i.jsxs)("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[(0,i.jsx)("input",{type:"checkbox",defaultChecked:e.enableEntryNotifications,onChange:e=>s({enableEntryNotifications:e.target.checked}),className:"rounded"}),(0,i.jsx)("span",{children:"Notify on position entries"})]}),(0,i.jsxs)("label",{className:"flex items-center gap-2 text-sm cursor-pointer mt-2",children:[(0,i.jsx)("input",{type:"checkbox",defaultChecked:e.enableExitNotifications,onChange:e=>s({enableExitNotifications:e.target.checked}),className:"rounded"}),(0,i.jsx)("span",{children:"Notify on position exits"})]})]})]})]})}var j=t(9556),N=t(6745),v=t(6889);function y(e){let{address:s,username:t}=e,[n,r]=(0,a.useState)("positions"),{data:c,isLoading:d}=(0,j.I)({queryKey:["positions",s],queryFn:async()=>{let e=await fetch("/api/positions?address=".concat(s));if(!e.ok)throw Error("Failed to fetch positions");return e.json()}}),{data:l,isLoading:o}=(0,j.I)({queryKey:["trades",s],queryFn:async()=>{let e=await fetch("/api/trades?address=".concat(s,"&limit=20"));if(!e.ok)throw Error("Failed to fetch trades");return e.json()}}),x=(null==c?void 0:c.filter(e=>e.isOpen))||[],m=x.reduce((e,s)=>e+s.pnl,0);return(0,i.jsxs)("div",{className:"bg-zinc-900 rounded-lg border border-zinc-800",children:[(0,i.jsxs)("div",{className:"p-4 border-b border-zinc-800",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:t}),(0,i.jsxs)("p",{className:"text-sm text-zinc-500 font-mono",children:[s.slice(0,6),"...",s.slice(-4)]})]}),x.length>0&&(0,i.jsxs)("div",{className:"text-right",children:[(0,i.jsx)("div",{className:"text-xs text-zinc-500",children:"Total P&L"}),(0,i.jsxs)("div",{className:"text-lg font-semibold ".concat(m>=0?"text-green-500":"text-red-500"),children:[m>=0?"+":"","$",m.toFixed(2)]})]})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("button",{onClick:()=>r("positions"),className:"flex-1 px-4 py-2 rounded-lg font-medium text-sm transition-colors ".concat("positions"===n?"bg-blue-600 text-white":"bg-zinc-800 text-zinc-400 hover:bg-zinc-700"),children:(0,i.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,i.jsx)(N.A,{className:"w-4 h-4"}),"Positions (",x.length,")"]})}),(0,i.jsx)("button",{onClick:()=>r("trades"),className:"flex-1 px-4 py-2 rounded-lg font-medium text-sm transition-colors ".concat("trades"===n?"bg-blue-600 text-white":"bg-zinc-800 text-zinc-400 hover:bg-zinc-700"),children:(0,i.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,i.jsx)(v.A,{className:"w-4 h-4"}),"Recent Trades"]})})]})]}),(0,i.jsx)("div",{className:"divide-y divide-zinc-800",children:"positions"===n?d?(0,i.jsx)("div",{className:"p-8 text-center text-zinc-500",children:"Loading positions..."}):0===x.length?(0,i.jsx)("div",{className:"p-8 text-center text-zinc-500",children:"No open positions"}):x.map(e=>(0,i.jsxs)("div",{className:"p-4 hover:bg-zinc-800/50 transition-colors",children:[(0,i.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h4",{className:"font-medium text-sm mb-1",children:e.market.question}),(0,i.jsxs)("div",{className:"flex items-center gap-2 text-xs text-zinc-500",children:[(0,i.jsx)("span",{className:"px-2 py-0.5 rounded ".concat("YES"===e.outcome?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"),children:e.outcome}),(0,i.jsxs)("span",{children:["Size: $",e.size.toFixed(2)]})]})]}),(0,i.jsxs)("div",{className:"text-right ml-4",children:[(0,i.jsxs)("div",{className:"text-sm font-semibold ".concat(e.pnl>=0?"text-green-500":"text-red-500"),children:[e.pnl>=0?"+":"","$",e.pnl.toFixed(2)]}),(0,i.jsxs)("div",{className:"text-xs ".concat(e.pnl>=0?"text-green-500":"text-red-500"),children:[e.pnlPercentage>=0?"+":"",e.pnlPercentage.toFixed(1),"%"]})]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-4 text-xs text-zinc-600",children:[(0,i.jsxs)("span",{children:["Avg: ",(100*e.averagePrice).toFixed(1),"\xa2"]}),(0,i.jsxs)("span",{children:["Current: ",(100*e.currentPrice).toFixed(1),"\xa2"]}),(0,i.jsxs)("span",{children:["Opened: ",new Date(e.createdAt).toLocaleDateString()]})]})]},e.id)):o?(0,i.jsx)("div",{className:"p-8 text-center text-zinc-500",children:"Loading trades..."}):l&&0!==l.length?l.map(e=>(0,i.jsxs)("div",{className:"p-4 hover:bg-zinc-800/50 transition-colors",children:[(0,i.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("h4",{className:"font-medium text-sm mb-1",children:e.market.question}),(0,i.jsxs)("div",{className:"flex items-center gap-2 text-xs text-zinc-500",children:[(0,i.jsx)("span",{className:"px-2 py-0.5 rounded ".concat("YES"===e.outcome?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"),children:e.outcome}),(0,i.jsx)("span",{className:"px-2 py-0.5 rounded ".concat("BUY"===e.type?"bg-blue-500/20 text-blue-400":"bg-orange-500/20 text-orange-400"),children:e.type})]})]}),(0,i.jsxs)("div",{className:"text-right ml-4",children:[(0,i.jsxs)("div",{className:"text-sm font-semibold",children:["$",e.size.toFixed(2)]}),(0,i.jsxs)("div",{className:"text-xs text-zinc-500",children:[(100*e.price).toFixed(1),"\xa2"]})]})]}),(0,i.jsx)("div",{className:"text-xs text-zinc-600",children:new Date(e.timestamp).toLocaleString()})]},e.id)):(0,i.jsx)("div",{className:"p-8 text-center text-zinc-500",children:"No recent trades"})})]})}var z=t(6878);function k(){let e=c(e=>e.trackedTraders);return!function(){let e=c(e=>e.trackedTraders),s=c(e=>e.notificationSettings),t=(0,a.useRef)(new Map);e.forEach(e=>{let{data:i}=(0,j.I)({queryKey:["trades",e.address],queryFn:async()=>{let s=await fetch("/api/trades?address=".concat(e.address,"&limit=1"));return s.ok?s.json():[]},enabled:e.notificationsEnabled,refetchInterval:3e4});(0,a.useEffect)(()=>{if(!i||0===i.length||!e.notificationsEnabled||!s.discordWebhookUrl)return;let a=i[0],n=t.current.get(e.address);if(n&&n!==a.id){let t="BUY"===a.type;(t&&s.enableEntryNotifications||!t&&s.enableExitNotifications)&&fetch("/api/notify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({webhookUrl:s.discordWebhookUrl,username:e.username,type:"trade",trade:a})}).catch(console.error)}t.current.set(e.address,a.id)},[i,e,s])})}(),(0,i.jsxs)("div",{className:"min-h-screen bg-black",children:[(0,i.jsx)("header",{className:"border-b border-zinc-800 bg-zinc-900/50 backdrop-blur-sm sticky top-0 z-10",children:(0,i.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"p-2 bg-blue-600 rounded-lg",children:(0,i.jsx)(z.A,{className:"w-6 h-6"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-2xl font-bold",children:"Polymarket Tracker"}),(0,i.jsx)("p",{className:"text-sm text-zinc-500",children:"Monitor traders and get notified instantly"})]})]})})}),(0,i.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,i.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,i.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,i.jsx)(o,{}),(0,i.jsx)(f,{}),(0,i.jsx)(p,{})]}),(0,i.jsx)("div",{className:"lg:col-span-2 space-y-6",children:0===e.length?(0,i.jsx)("div",{className:"bg-zinc-900 rounded-lg border border-zinc-800 p-12 text-center",children:(0,i.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,i.jsx)(z.A,{className:"w-16 h-16 mx-auto mb-4 text-zinc-700"}),(0,i.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Start Tracking Traders"}),(0,i.jsx)("p",{className:"text-zinc-500 mb-6",children:"Add a Polymarket trader by their username or wallet address to monitor their positions and receive notifications on every trade."}),(0,i.jsxs)("div",{className:"space-y-2 text-sm text-zinc-600 text-left bg-zinc-800 rounded-lg p-4",children:[(0,i.jsx)("p",{children:"✓ Track active positions and P&L"}),(0,i.jsx)("p",{children:"✓ View complete trade history"}),(0,i.jsx)("p",{children:"✓ Get Discord notifications on entries/exits"}),(0,i.jsx)("p",{children:"✓ Monitor multiple traders simultaneously"})]})]})}):e.map(e=>(0,i.jsx)(y,{address:e.address,username:e.username},e.id))})]})}),(0,i.jsx)("footer",{className:"border-t border-zinc-800 mt-12",children:(0,i.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,i.jsx)("p",{className:"text-center text-sm text-zinc-600",children:"Built for tracking Polymarket traders • Data updates every 30 seconds"})})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[527,218,441,517,358],()=>s(5196)),_N_E=e.O()}]);